#:kivy 1.10.1
#: import NoTransition kivy.uix.screenmanager.NoTransition
#: import utils kivy.utils

<AnchorGridCell@AnchorLayout>:
    anchor_x: 'center'
    anchor_y: 'center'

<UiButton@Button>:
    font_size: self.width / 6
    text_size: self.size
    size_hint: .2, .9
    halign: 'center'
    valign: 'center'
    background_color: 0,0,0,0
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex("4F5D75")
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [(20, 20), (20, 20), (20, 20), (20, 20)]

<HeaderLabel@Label>:
    text_size: self.size
    font_size: self.width / 12
    halign: 'center'
    valign: 'bottom'

<InputLabel@Label>:
    font_size: self.width / 10
    text_size: self.size
    halign: 'left'
    valign: 'center'

<OutputLabel@Label>:
    font_size: self.width / 10
    text_size: self.size
    halign: 'right'
    valign: 'center'

<TextCollection@TextInput>:
    multiline: False
    size_hint: 1, .7
    font_size: self.width / 9

<ButtonBoxLayout>:
    padding: self.width / 40
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex("#4F5D75")
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [(40, 40), (40, 40), (40, 40), (40, 40)]

<StyledGridLayout@GridLayout>:
    cols: 2
    height: self.minimum_height
    size_hint_y: None
    row_force_default: True
    row_default_height: self.width / 8
    col_default_width: self.width / 4
    padding: self.width / 25
    spacing: self.width / 25, self.width / 50
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex("4F5D75")
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [(20, 20), (20, 20), (20, 20), (20, 20)]

<PageGridLayout@GridLayout>:
    cols: 1
    height: self.minimum_height
    size_hint_y: None
    row_force_default: True
    row_default_height: self.width / 13
    padding: self.width / 15
    spacing: self.width / 20
    
<ScreenManager>
    transition: NoTransition()

<MainOverview>:
    FloatLayout:
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'top'
            ScrollView:
                do_scroll_x: False
                do_scroll_y: True
                PageGridLayout:
                    height: machineButtons.minimum_height + self.minimum_height
                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'bottom'
                        HeaderLabel:
                            text: 'All Currently Added Machines'
                            font_size: self.width / 15
                    StackLayout:
                        orientation: 'lr-tb'
                        spacing: self.width / 50
                        UiButton:
                            text: 'Add Machine'
                            size_hint: .2, .9
                            on_release: root.manager.current = 'AddMachinePage'
                        UiButton:
                            text: 'Delete Machine'
                            size_hint: .2, .9
                        Label:
                            text: 'Sort By'
                            text_size: self.size
                            halign: 'right'
                            valign: 'center'
                            size_hint: .25, .9
                        UiButton:
                            text: 'Name'
                            size_hint: .3, .9
                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'top'
                        GridLayout:
                            id: machineButtons
                            cols: 1
                            height: self.minimum_height
                            row_force_default: True
                            size_hint_y: None
                            row_default_height: self.width / 3
                            col_default_width: self.width / 4
                            padding: self.width / 25
                            spacing: self.width / 25, self.width / 50 
                                
<MachineStatusPage>:
    on_enter: root.start()
    on_leave: root.stop()
    FloatLayout:
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'top'
            ScrollView:
                do_scroll_x: False
                do_scroll_y: True
                PageGridLayout:
                    height: self.minimum_height + body.minimum_height
                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'bottom'
                        HeaderLabel:
                            id: selectedMachine
                            text: root.selectedMachine
                    StackLayout:
                        orientation: 'lr-tb'
                        spacing: self.width / 50
                        UiButton:
                            text: 'Go Back'
                            on_release: root.manager.current = 'MainOverview'
                        UiButton:
                            text: 'Edit Job'
                            on_release:
                                root.manager.current = 'AddJobPage'
                                root.manager.current_screen.selectedMachine = selectedMachine.text
                                root.manager.current_screen.Part_Name = root.Part_Name
                                root.manager.current_screen.Part_Desc = root.Part_Desc
                                root.manager.current_screen.Parts_Needed = root.Parts_Needed
                                root.manager.current_screen.Time_Per_Part = root.Time_Per_Part
                                root.manager.current_screen.Oal = root.Oal
                                root.manager.current_screen.Cut_Off_Width = root.Cut_Off_Width
                                root.manager.current_screen.Bar_Length = root.Bar_Length
                                root.manager.current_screen.Bar_Parameter = root.Bar_Parameter
                        UiButton:
                            text: 'New Job'
                            on_release:
                                root.manager.current = 'AddJobPage'
                                root.manager.current_screen.selectedMachine = selectedMachine.text
                                root.manager.current_screen.Part_Name = ""
                                root.manager.current_screen.Part_Desc = ""
                                root.manager.current_screen.Parts_Needed = ""
                                root.manager.current_screen.Time_Per_Part = ""
                                root.manager.current_screen.Oal = ""
                                root.manager.current_screen.Cut_Off_Width = ""
                                root.manager.current_screen.Bar_Length = ""
                                root.manager.current_screen.Bar_Parameter = ""
                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'top'
                        HeaderLabel:
                            text: "Current Job"
                        StyledGridLayout:
                            id: body
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Current Job: '
                            AnchorGridCell:
                                OutputLabel:
                                    text: root.Part_Name
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Job Description'
                            AnchorGridCell:
                                OutputLabel:
                                    text: root.Part_Desc
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Parts Needed: '
                            AnchorGridCell:
                                OutputLabel:
                                    text: root.Parts_Needed
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Parts Remaining: '
                            AnchorGridCell:
                                OutputLabel:
                                    text: root.Parts_Left
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Time Per Part: '
                            AnchorGridCell:
                                OutputLabel:
                                    text: root.Time_Per_Part
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Completion Time: '
                            AnchorGridCell:
                                OutputLabel:
                                    text: root.Completion_Time
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Time Left: '
                            AnchorGridCell:
                                OutputLabel:
                                    text: root.Time_Left
                    
<AddJobPage>:
    FloatLayout:
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'top'
            ScrollView:
                do_scroll_x: False
                do_scroll_y: True
                PageGridLayout:
                    height: self.minimum_height + body.minimum_height
                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'bottom'
                        HeaderLabel:
                            text: root.selectedMachine + " " + "Add/Edit Job"
                    StackLayout:
                        orientation: 'lr-tb'
                        spacing: self.width / 50
                        UiButton:
                            text: "Cancel"
                            on_release: root.manager.current = 'MachineStatusPage'
                        UiButton:
                            text: "Submit"
                            on_release:
                                root.Part_Name = part_name.text
                                root.Part_Desc = part_desc.text
                                root.Parts_Needed = parts_needed.text
                                root.Time_Per_Part = time_per_part.text
                                root.Oal = oal.text
                                root.Cut_Off_Width = cut_off_width.text
                                root.Bar_Length = bar_length.text
                                root.Bar_Parameter = bar_parameter.text
                                root.addNewJob()
                                root.manager.current = 'MachineStatusPage'
                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'top'
                        StyledGridLayout:
                            id: body
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Part Name/Num: '
                            AnchorGridCell:
                                TextCollection:
                                    id: part_name
                                    text: root.Part_Name
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Description: '
                            AnchorGridCell:
                                TextCollection:
                                    id: part_desc
                                    text: root.Part_Desc
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Parts Needed: '
                            AnchorGridCell:
                                TextCollection:
                                    id: parts_needed
                                    text: root.Parts_Needed
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Machining Time (sec): '
                            AnchorGridCell:
                                TextCollection:
                                    id: time_per_part
                                    text: root.Time_Per_Part
                            AnchorGridCell:
                                InputLabel:
                                    text: 'OAL (in): '
                            AnchorGridCell:
                                TextCollection:
                                    id: oal
                                    text: root.Oal
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Cutoff Width (in): '
                            AnchorGridCell:
                                TextCollection:
                                    id: cut_off_width
                                    text: root.Cut_Off_Width
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Length Of Bar (in): '
                            AnchorGridCell:
                                TextCollection:
                                    id: bar_length
                                    text: root.Bar_Length
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Bar Remnant Parameter (in): '
                            AnchorGridCell:
                                TextCollection:
                                    id: bar_parameter
                                    text: root.Bar_Parameter
      
<AddMachinePage>:
    FloatLayout:
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'top'
            ScrollView:
                do_scroll_x: False
                do_scroll_y: True
                PageGridLayout:
                    height: self.minimum_height + body.minimum_height
                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'bottom'
                        HeaderLabel:
                            text: 'New Machine'
                    StackLayout:
                        orientation: 'lr-tb'
                        spacing: self.width / 50
                        UiButton:
                            text: "Cancel"
                            on_release: root.manager.current = 'MainOverview'
                        UiButton:
                            text: "Submit"
                            on_release:
                                root.machineName = machineName.text
                                root.desc = desc.text
                                root.machineType = machineType.text
                                root.location = location.text
                                root.addNewMachine()
                                root.manager.current = 'MainOverview'
                                root.manager.current_screen.stop()
                                root.manager.current_screen.start()  
                    AnchorLayout:
                        anchor_x: 'center'
                        anchor_y: 'top'
                        StyledGridLayout:
                            id: body
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Name: '
                            AnchorGridCell:
                                TextCollection:
                                    id: machineName
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Description: '
                            AnchorGridCell:
                                TextCollection:
                                    id: desc
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Type: '
                            AnchorGridCell:
                                TextCollection:
                                    id: machineType
                            AnchorGridCell:
                                InputLabel:
                                    text: 'Location: '
                            AnchorGridCell:
                                TextCollection:
                                    id: location
